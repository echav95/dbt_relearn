semantic_models:
- name: listings_with_host
  description: A combined table of Airbnb listings with host details.
  model: ref('dim_listings_w_host')
  defaults:
    agg_time_dimension: created_at
  entities:
  - name: listing
    type: primary
    expr: listing_id
  - name: host
    type: foreign
    expr: host_id
  dimensions:
  - name: name
    expr: listing_name
    type: categorical
  - name: room_type
    type: categorical
  - name: host_name
    type: categorical
  - name: host_is_superhost
    type: categorical
  - name: created_at
    type: time
    type_params:
      time_granularity: day
  - name: updated_at
    type: time
    type_params:
      time_granularity: day
  measures:
  - name: minimum_nights
    description: Minimum number of nights for a listing.
    agg: average
    create_metric: true
    expr: minimum_nights
  - name: price
    description: Price of the listing.
    agg: average
    create_metric: true
    expr: price
  - name: count_listing
    agg: count
    create_metric: true
    expr: listing_id
  - name: count_host
    agg: count_distinct
    create_metric: true
    expr: host_id
